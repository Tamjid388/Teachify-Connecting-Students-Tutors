enum BookingStatus {
  PENDING
  ACCEPTED
  REJECTED
  COMPLETED
  CANCELLED
}

enum TuitionMode {
  ONLINE
  OFFLINE
  BOTH
}

enum PaymentStatus {
  UNPAID
  PAID
}

model Booking {
  booking_id    String        @id @default(uuid())
  bookingStatus BookingStatus @default(PENDING)

  startTime     DateTime
  endTime       DateTime
  duration      Int              @default(60)
  tutionMode    TuitionMode      @default(ONLINE)
  paymentStatus PaymentStatus    @default(UNPAID)
  studentId     String
  tutor_id      String
  isReviewed    Boolean          @default(false)
  slotId        String
  review        Review?
  createdAt     DateTime         @default(now())
  updatedAt     DateTime         @updatedAt
  // relations
  tutor         Tutor            @relation(fields: [tutor_id], references: [tutor_id])
  student       User             @relation(fields: [studentId], references: [id])
  slot          AvailabilitySlot @relation(fields: [slotId], references: [id])

  @@index([studentId])
  @@index([tutor_id])
  @@map("bookings")
}

model AvailabilitySlot {
  id        String    @id @default(uuid())
  tutorId   String
  day       DayOfWeek
  startTime String
  endTime   String
  isBooked  Boolean   @default(false)
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt

  tutor Tutor @relation(fields: [tutorId], references: [tutor_id])

  bookings Booking[]

  @@unique([tutorId, day, startTime, endTime])
  @@index([tutorId])
  @@map("availability_slots")
}

enum DayOfWeek {
  SUN
  MON
  TUE
  WED
  THU
  FRI
  SAT
}
